
<!-- README.md is generated from README.Rmd. Please edit that file -->

# GenDID

<!-- badges: start -->

<!-- badges: end -->

The goal of GenDID is to implement the generalized DID estimator
approach for the analysis of stepped wedge cluster-randomized trials and
observational/quasi-experimental panel data. See the manuscript “A
Generalized Difference-in-Differences Estimator for Randomized
Stepped-Wedge and Observational Staggered Adoption Settings” by Lee
Kennedy-Shaffer at <https://arxiv.org/abs/2405.08730>. Currently in
revision; a link to the final manuscript will be made available upon
publication.

Created by: Lee Kennedy-Shaffer, PhD, Assistant Professor of
Biostatistics, Yale School of Public Health, New Haven, CT, USA

Please contact lee.kennedy-shaffer (at) yale.edu with any questions.

## Directory Structure and Key Files

N.B.: All workflows are designed to be run with the overarching
directory as the working directory, not the directory in which the
script is found.

- `data`: The synthetic, publicly available version of the Xpert data,
  based on the real data collected by [Trajman et
  al. (2015)](https://doi.org/10.1371/journal.pone.0123252) for a
  stepped-wedge trial in Brazil. The real data are not publicly
  available, but were provided to the author by Prof. Anete Trajman,
  with assistance from Prof. Jennifer Thompson in ensuring comparability
  with [Thompson et al. (2018)](https://doi.org/10.1002/sim.7668).

- `figs`: Figure output from the analyses conducted.

- `int`: Intermediate output from the Xpert data analysis.

- `R`: Scripts for running the GenDID functions as well as the Xpert
  analysis.

  - `Analysis.R` provides the main functions that can be used for a full
    analysis using the GenDID methods.

  - `Sigmas.R` provides functions for generating variance-covariance
    structures that can be used in GenDID analyses.

  - `ToyExample.R` demonstrates how the GenDID method identifies the
    appropriate estimator in small-scale toy examples, as outlined in
    the paper.

  - `Xpert-analysis.R` conducts the full analysis using the synthetic
    Xpert data set in the `data/` directory.

  - `Ext_Comps.R` provides functions for other methods commonly used in
    the analysis of stepped wedge trials or staggered adoption studies.
    Note that these call other packages or routines; the versions
    implemented here are provided without warranty by the author.
    Investigators should refer to the manuscripts, packages, and
    documentations for the original methods if using these approaches.

- `res`: Results from the Xpert data analysis. Analyses were conducted
  using R version 4.5.2.

- `sim_data`: Simulated data and simulation generation and analysis
  settings used for the simulation study in the paper. These files are
  generated by the `sim_R/Sim_Setup.R` script.

- `sim_R`: Scripts used for the creation, analysis, and compilation of
  the simulation study in the paper. Note that these functions require
  functions from the `R/` directory scripts to run properly.

  - `Sim_Setup.R` generates the data and settings.

  - `Sim_Analysis.R` demonstrates how to analyze the simulated data sets
    (the full analysis would take several days to run locally without
    parallelization).

  - `Sim_Cluster.R` is the script actually used to run the simulation
    analyses, which was conducted on a high-perfoming computer cluster
    in batches of 10 simulations per job, using R version 4.4.1.

  - `Sim_Cluster_Compile.R` is the script used to compile the simulation
    analysis results, which was conducted on a high-perfoming computer
    cluster in batches of 10 simulations per job, using R version 4.4.1.

  - `Sim_Compile.R` is a script that could be used to compile the
    simulation analysis results if they were run using the
    `Sim_Analysis.R` script.

  - `Sim_Plots.R` generates the output figures and results from the
    simulation study.

- `sim_res`: Results and figures from the simulation study.

## Packages Used

Throughout this repository, functions from `tidyverse` v.2.0.0
(specifically: `tibble`, `dplyr`, `tidyr`, `stringr`, `ggplot2`) are
used.

In addition, the following packages are used for comparison stepped
wedge/staggered adoption analysis methods:

- `lme4` v. 1.1-37 for mixed effects models, referred to as MEM (see
  [Hussey and Hughes (2007)](https://doi.org/10.1016/j.cct.2006.05.007))
  and CPI (see [Hooper et al. (2016)](https://doi.org/10.1002/sim.7028))

- `bbmle` v.1.0.25.1 for implementation of composite likelihood methods
  (see [Voldal et al. (2024)](https://doi.org/10.1002/sim.10120) for
  details and code for implementing those models)

- `did` v.2.1.2 for implementation of the [Callaway and Sant’Anna
  (2021)](https://doi.org/10.1016/j.jeconom.2020.12.001) staggered
  adoption method

- `fixest` v.0.12.1 for implementation of two-way fixed effects (see,
  e.g., [Goodman-Bacon
  (2021)](https://doi.org/10.1016/j.jeconom.2021.03.014)) and the [Sun
  and Abraham (2021)](https://doi.org/10.1016/j.jeconom.2020.09.006)
  staggered adoption methods

- `DIDmultiplegt` v.2.0.0 for implementation of the [de Chaisemartin and
  d’Haultfœuille (2020)](https://doi.org/10.1257/aer.20181169) method

- Additional methods, including those proposed by [Thompson et
  al. (2018)](https://doi.org/10.1002/sim.7668) and [Kennedy-Shaffer et
  al. (2020)](https://doi.org/10.1002/sim.8451) are implemented without
  additional packages

The comparisons using these external packages and functions are
implemented by the author for the analyses conducted for the paper; this
code may not work for all anaylses using these methods; investigators
should refer to the original articles and code documentation for
details.

For methods that can be implemented within the GenDID framework, the
functions in `Analysis.R` permit these analyses without use of external
packages or functions. See the manuscript for details.
